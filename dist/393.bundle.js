"use strict";(globalThis.webpackChunk_MikaEdit=globalThis.webpackChunk_MikaEdit||[]).push([[393],{5393:(e,n,t)=>{t.r(n),t.d(n,{default:()=>z});var r=t(2197),i=t(3361),l=t(515),a=t(2709),o=t(7207),c=t(4788),s=[{filename:"src",value:"",path:"src",kind:"directory",children:[{filename:"index.html",value:"<h1>This is Preact page</h1>\n<img src=\"https://preactjs.com/branding/logo-text.svg\" />\n<div id='app'></div>\n",path:"src/index.html"},{filename:"index.js",value:"import {\n    html,\n    render,\n    useReducer,\n    useState\n} from '//unpkg.com/htm/preact/standalone.mjs';\n\nfunction Toggle(props) {\n    const [count, setCount] = useState(0);\n    const [on, toggle] = useReducer((x) => !x, props.on);\n    const [list, setList] = useState([\n        { text: 'Write my first post', completed: true },\n        { text: 'Buy new groceries', completed: false },\n        { text: 'Walk the dog', completed: false }\n    ]);\n    return html`\n        <div class=\"counter-container\">\n            <button onClick=${() => setCount(count + 1)}>Increment</button>\n            <input readonly value=${count} />\n            <button onClick=${() => setCount(count - 1)}>Decrement</button>\n        </div>\n        <label>\n            <input type=\"checkbox\" value=${on} onClick=${toggle} />\n            Check Me\n        </label>\n        <output>${on && 'check'}mate</output>\n        <div class=\"counter-list\">\n            ${list.map(\n                (item) => html`\n                    <li key=\"${item.text}\">content: ${item.text}</li>\n                `\n            )}\n        </div>\n    `;\n}\n\nrender(html`<${Toggle} />`, document.querySelector('#app'));\n",path:"src/index.js"},{filename:"index.css",value:"body {\n  font: 16px system-ui;\n  padding: 20px;\n  background-color: #38235c;\n  color: #fff\n}\nh1{\n  font-size: 34px;\n  font-weight: 500;\n  width: 100%;\n  text-align: center;\n}\n#app{\n  margin-top: 30px;\n}\nlabel {\n  display: inline-flex;\n  padding: 5px;\n  background: #ddd;\n  border: 1px solid #bbb;\n  border-radius: 5px;\n  user-select: none;\n}\noutput {\n  display: inline-flex;\n  margin-left: 10px;\n  border: 1px solid #abc;\n  padding: 5px 10px;\n  background: #ace;\n}\n.counter-container {\n  margin-bottom: 40px;\n    input, button {\n        margin: 0.5rem;\n        text-align: center;\n    }\n}\n.counter-list{\n  margin-top: 40px;\n  li{\n    margin: 10px 0;\n  }\n}",path:"src/index.css"}]}],u=t(6205),d=t(8347),p=t(8833),f=function(e,n,t){var r,i={"index.html":e};((null==n||null===(r=n[0])||void 0===r?void 0:r.children)||[]).forEach(function(e){/index.html/.test(e.filename)||(i["".concat(e.filename)]=e.value)}),null==i||i["index.js"];var l=null==i?void 0:i["index.css"],a=null==i?void 0:i["index.js"],o=null==i?void 0:i["index.html"],c=document.createElement("iframe");c.setAttribute("id","frameLive"),c.setAttribute("width","100%"),c.setAttribute("height","100%"),c.setAttribute("style","border:0px"),c.setAttribute("srcdoc",'<!DOCTYPE html>\n<html lang="zh-CN">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>preact preview page</title>\n    <style>'.concat(l,"</style>\n</head>\n<body>\n<script>\nwindow.console=window.parent.console;\n<\/script>\n").concat(o,'\n    <script type="module" id="rendered-js">\n            ').concat(a,"\n        <\/script>\n    </body>\n    </html>")),document.getElementById("previewFrame").innerHTML="",document.getElementById("previewFrame").appendChild(c)},m=t(1187),h=t(7453),v=t(3759),x=t(4539),y=t(7861),b=t(8918),g=t(475),w=t(9075),k=t(3790),j=function(){return j=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},j.apply(this,arguments)},C=function(e,n,t){if(t||2===arguments.length)for(var r,i=0,l=n.length;i<l;i++)!r&&i in n||(r||(r=Array.prototype.slice.call(n,0,i)),r[i]=n[i]);return e.concat(r||Array.prototype.slice.call(n))};const U=(0,w.PA)(function(e){var n,t=this,w=(0,r.useState)({}),U=(w[0],w[1]),A=(0,r.useState)([s[0].children[0].path]),F=A[0],I=A[1],O=l.Ay.useMessage(),E=O[0],S=O[1],N=(0,r.useState)(null),P=N[0],H=(N[1],(0,r.useState)("")),T=H[0],$=H[1],D=(0,r.useState)(""),B=D[0],M=D[1],R=(0,r.useState)(""),_=R[0],z=R[1],J=(0,r.useState)([null===(n=s[0])||void 0===n?void 0:n.path]),L=J[0],G=J[1],W=function(e){var n=(0,k.HO)(u.U.currentFiles);(n[0].children||[]).forEach(function(e){e.path===_&&(e.filename=B)}),u.U.setCurrentFiles(n);var t={id:"daryl",name:"daryl",templates:(0,k.HO)(n)};(0,g.O6)(u.U.currentIndexDBInstance.db,"preact-ng-templates",t);var r=n[0].children.find(function(e){return e.filename.includes("index.html")});f((null==r?void 0:r.value)||"",n),$(""),M(""),z("")},K=function(e){if(e.preventDefault(),e.stopPropagation(),!P){var n=(0,k.HO)(u.U.currentFiles);(n[0].children||[]).forEach(function(e){e.path===_&&(e.filename=B)});var t=n[0].children;if(t.length>7)E.open({type:"error",content:"maxium file number reached ！！"});else{var r={filename:"newFile".concat(t.length,".js"),path:"src/newFile".concat(t.length,".js"),value:" "};n[0].children.push(r),u.U.setCurrentFiles(n);var i={id:"daryl",name:"daryl",templates:(0,k.HO)(n)};(0,g.O6)(u.U.currentIndexDBInstance.db,"mika-preact-templates",i)}}},Q=function(e,n){var t,r,i,l,a,o,c;window._canSelectTree&&("directory"!==(null===(t=null==n?void 0:n.node)||void 0===t?void 0:t.kind)&&u.U.updateCode((0,p._P)(u.U.currentFiles,null===(r=null==n?void 0:n.node)||void 0===r?void 0:r.path)||"",null===(i=null==n?void 0:n.node)||void 0===i?void 0:i.path),"directory"!==(null===(l=null==n?void 0:n.node)||void 0===l?void 0:l.kind)&&u.U.updateInfo((null==n?void 0:n.node)||""),G(L.includes(null===(a=null==n?void 0:n.node)||void 0===a?void 0:a.filename)?L.filter(function(e){return e!==n.node.filename}):C(C([],L,!0),[null===(o=null==n?void 0:n.node)||void 0===o?void 0:o.filename],!1)),I([null===(c=null==n?void 0:n.node)||void 0===c?void 0:c.path]),$(""),z(""))};return(0,r.useEffect)(function(){var e={db:null,storeName:"mika-preact-templates",version:1},n={id:"daryl",name:"daryl",templates:s};setTimeout(function(){return r=t,i=void 0,a=function(){var t,r,i,l,a;return function(e,n){var t,r,i,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(o){return function(c){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,o[0]&&(l=0)),l;)try{if(t=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,r=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!((i=(i=l.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){l=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){l.label=o[1];break}if(6===o[0]&&l.label<i[1]){l.label=i[1],i=o;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(o);break}i[2]&&l.ops.pop(),l.trys.pop();continue}o=n.call(e,l)}catch(e){o=[6,e],r=0}finally{t=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}}(this,function(o){switch(o.label){case 0:return[4,(0,g.r6)(e)];case 1:t=o.sent(),u.U.setCurrentFiles(s),u.U.setCurrentIndexDBInstance(t),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,(0,g.bQ)(t.db,"mika-preact-templates","daryl")];case 3:return(null==(r=o.sent())?void 0:r.templates)?u.U.setCurrentFiles(r.templates):(0,g.ys)(t.db,"mika-preact-templates",n),i=((null==r?void 0:r.templates)||s)[0].children.find(function(e){return e.filename.includes("index.html")}),u.U.updateCode(i.value,"index.html"),u.U.updateInfo(i),U(i),l=setInterval(function(){document.getElementById("previewFrame")&&(f((null==i?void 0:i.value)||"",(null==r?void 0:r.templates)||s),clearInterval(l))},500),[3,5];case 4:return a=o.sent(),console.log(a),[3,5];case 5:return[2]}})},new((l=void 0)||(l=Promise))(function(e,n){function t(e){try{c(a.next(e))}catch(e){n(e)}}function o(e){try{c(a.throw(e))}catch(e){n(e)}}function c(n){var r;n.done?e(n.value):(r=n.value,r instanceof l?r:new l(function(e){e(r)})).then(t,o)}c((a=a.apply(r,i||[])).next())});var r,i,l,a})},[]),(0,r.useEffect)(function(){d.H.switchFileNode.length>0&&Q(0,{node:{path:d.H.switchFileNode[0],filename:d.H.switchFileNode[0]}})},[d.H.switchFileNode]),(0,i.jsxs)("div",{className:"mika-mona-left-dir",children:[S,u.U.currentFiles.length>0&&(0,i.jsx)(o.A,{showLine:!1,showIcon:!0,icon:(0,i.jsx)(m.A,{}),switcherIcon:(0,i.jsx)(h.A,{}),onSelect:Q,onRightClick:function(e){var n;$(null===(n=null==e?void 0:e.node)||void 0===n?void 0:n.path)},selectedKeys:F,onExpand:function(e,n){G(e)},expandedKeys:L,titleRender:function(e){return _===e.path?(0,i.jsx)(c.A,{size:"small",value:B,onClick:function(e){e.stopPropagation()},onFocus:function(e){e.stopPropagation()},onInput:function(e){!function(e){M(e.target.value)}(e)},onBlur:W}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"mika-mona-left-dir-title",children:e.filename}),"src"===e.path&&(0,i.jsx)("span",{className:"mika-mona-left-dir-title-add",onClick:K,children:(0,i.jsx)(v.A,{})}),T===e.path&&!(/App.vue|app.jsx|index.html|index.js|index.css/.test(T)||"src"===T)&&(0,i.jsxs)("div",{className:"mika-mona-left-dir-title-op",children:[(0,i.jsx)("span",{children:(0,i.jsx)(x.A,{onClick:function(n){!function(e,n){e.preventDefault(),e.stopPropagation(),M(null==n?void 0:n.filename),z(null==n?void 0:n.path)}(n,e)}})}),(0,i.jsx)("span",{children:(0,i.jsx)(y.A,{onClick:function(n){return function(e,n){e.preventDefault(),e.stopPropagation(),a.A.confirm({title:"Are you sure you want to delete this file?",onOk:function(){var e=(0,k.HO)(u.U.currentFiles),t=e[0].children;t=t.filter(function(e){return e.path!==n.path}),e[0].children=t,u.U.setCurrentFiles(e);var r={id:"daryl",name:"daryl",templates:(0,k.HO)(e)};(0,g.O6)(u.U.currentIndexDBInstance.db,"mika-preact-templates",r),I([s[0].children[0].path]);var i=e[0].children.find(function(e){return e.filename.includes("index.html")});f((null==i?void 0:i.value)||"",e),Q(0,{node:i})}})}(n,e)}})})]})]})},treeData:(JSON.parse(JSON.stringify(u.U.currentFiles))||[]).map(function(e){return j(j({},e),{icon:"directory"===e.kind?(0,i.jsx)(b.A,{}):(0,i.jsx)(m.A,{})})}),fieldNames:{title:"filename",key:"path"}})]})});var A=t(4345),F=t(8463),I=t(5283),O=t(9082),E=t(3220),S=t(6745),N=t(5530),P=t(7427),H=t(2464),T=t(7463),$=function(e,n,t,r){return new(t||(t=Promise))(function(i,l){function a(e){try{c(r.next(e))}catch(e){l(e)}}function o(e){try{c(r.throw(e))}catch(e){l(e)}}function c(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(a,o)}c((r=r.apply(e,n||[])).next())})},D=function(e,n){var t,r,i,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(o){return function(c){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,o[0]&&(l=0)),l;)try{if(t=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,r=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!((i=(i=l.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){l=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){l.label=o[1];break}if(6===o[0]&&l.label<i[1]){l.label=i[1],i=o;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(o);break}i[2]&&l.ops.pop(),l.trys.pop();continue}o=n.call(e,l)}catch(e){o=[6,e],r=0}finally{t=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}};const B=(0,w.PA)(function(e){var n=this,t=(0,r.useMemo)(function(){return/.*\.html$/.test(u.U.path)?"html":/.*\.js$/.test(u.U.path)?"javascript":"css"},[u.U.path]),l=function(e,t){return $(n,void 0,void 0,function(){var n,t;return D(this,function(r){return u.U.replaceFileContent(e),u.U.updateCode(e||" "),n=(0,p._P)(u.U.currentFiles,"src/index.html"),f(n||"",JSON.parse(JSON.stringify(u.U.currentFiles))),t={id:"daryl",name:"daryl",templates:(0,k.HO)(u.U.currentFiles)},(0,g.O6)(u.U.currentIndexDBInstance.db,"mika-preact-templates",t),[2]})})};return(0,r.useEffect)(function(){d.H.updatedCode&&l(d.H.updatedCode)},[d.H.updatedCode]),(0,i.jsxs)("div",{className:"mika-mona-center-editor",children:[(0,i.jsx)(P.A,{placement:"bottom",color:"lime",title:"formatting codes",children:(0,i.jsx)(H.Ay,{className:"mika-mona-center-editor-format",shape:"circle",icon:(0,i.jsx)(T.A,{}),size:"small",onClick:function(){return $(n,void 0,void 0,function(){var e,n,r;return D(this,function(i){switch(i.label){case 0:e=u.U.code,n=null,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,F.GP("html"===t?e.split(/<script.*text\/x-handlebars[',"]/).join('<slot type="replace"').replace(/script>/g,"slot>"):e,{parser:"javascript"!==t?t:"babel",plugins:[I,S,O,E],tabWidth:4,useTabs:!1,semi:!0,singleQuote:!0,trailingComma:"none",bracketSpacing:!0,arrowParens:"always"})];case 2:return n=i.sent(),u.U.updateCode(" "),setTimeout(function(){var e="html"===t?n.replace(/<slot type="replace"/g,"<script type='text/x-handlebars'").replace(/slot>/g,"script>"):n;u.U.replaceFileContent(e),u.U.updateCode(e)},200),[3,4];case 3:return r=i.sent(),console.log(r),[2];case 4:return[2]}})})}})}),u.U.code&&(0,i.jsx)(A.Ay,{height:"calc(100vh - 66px)",language:"html"===t?"markdown":t,theme:"vs-dark",value:u.U.code,options:N.A,loading:(0,i.jsx)("div",{className:"monac-load",children:"编辑器加载中.."}),onChange:(0,p.N1)(l,1e3),onMount:function(e,n){e.focus()}})]})}),M=(0,w.PA)(function(e){var n=(0,r.useRef)(null);return(0,i.jsx)("div",{className:"mika-mona-right-view simpleFrame",id:"previewFrame",ref:n})});var R=t(6907),_=t(2595);t(3990);const z=(0,R.PA)(function(){return(0,r.useEffect)(function(){},[]),r.createElement(r.Fragment,null,r.createElement("div",{className:"App"},r.createElement(U,null),r.createElement(B,null),r.createElement(M,null)),r.createElement(_.A,{spinning:u.U.showSpin,percent:"auto",fullscreen:!0},"code服务运行中。。。"))})}}]);